---
layout: page
title: "/유사칸토어비트열"
permalink: /유사칸토어비트열
---

# 유사칸토어비트열

<img src="/assets/images/programmers/유사칸토어비트열.png" width="100%" alt="유사칸토어비트열" />
<img src="/assets/images/programmers/유사칸토어비트열-1.png" width="100%" alt="유사칸토어비트열" />
<img src="/assets/images/programmers/유사칸토어비트열-2.png" width="100%" alt="유사칸토어비트열" />

```python
def solution(n, l, r):
    return count_ones(n, l, r, True)

def count_ones(n, l, r, is_active):
    if not is_active:
        return 0

    if n == 1:
        return sum([1, 1, 0, 1, 1][l - 1 : r])

    bit_cnt = 5 ** (n - 1)
    start = 1
    cnt = 0

    for i in range(5):
        _from = start
        _to = start + bit_cnt - 1

        # i == 2 (가운데 블록)일 때는 비활성 상태
        block_is_active = (i != 2)

        if _from <= l and r <= _to:
            # 범위가 완전히 이 구간 안에 있음
            l_adjusted = l - _from + 1
            r_adjusted = r - _from + 1
            result = count_ones(n - 1, l_adjusted, r_adjusted, block_is_active)
            cnt += result
            break
        elif l <= _from and _to <= r:
            # 이 구간이 완전히 범위 안에 있음
            if block_is_active:
                cnt += 4 ** (n - 1)
        elif _from <= l <= _to:
            # l이 이 구간에 있고 r이 더 뒤에 있음
            l_adjusted = l - _from + 1
            result = count_ones(n - 1, l_adjusted, bit_cnt, block_is_active)
            cnt += result
        elif _from <= r <= _to:
            # r이 이 구간에 있고 l이 더 앞에 있음
            r_adjusted = r - _from + 1
            result = count_ones(n - 1, 1, r_adjusted, block_is_active)
            cnt += result

        start = _to + 1

    return cnt
```